Costa's semifinal opponent is Spaniard Juan Carlos Ferrero, whom he beat in last year's final.