Costa will play Juan Carlos Ferrero next in a rematch of last year's final.